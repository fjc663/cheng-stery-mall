import{u as H}from"./useAddress-fWOuFEY4.js";import{b as J}from"./element-china-area-data-BVDNhPol.js";import{d as K,i as L,e as n,c as A,w as a,r,o as V,a as t,f as s,t as x,u as N,b as _,_ as Q}from"./index-CMV7StrB.js";import"./http-Bo0dlXKR.js";import"./axios-BimPEqV4.js";const W={class:"address-actions"},X={class:"dialog-footer"},Y={class:"dialog-footer"},Z=K({__name:"AddressManager",setup(h){const{addresses:D,getAddress:c,setDefaultAddress:P,addNewAddress:U,updateAddress:$,deleteAddress:q}=H();L(()=>c());const v=n([]),z=n({receiverName:[{required:!0,message:"请输入用户名",trigger:"blur"},{max:50,message:"收货人名字字符长度最大为50",trigger:"blur"}],receiverPhone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{min:11,max:11,message:"请输入11位手机号码",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"请输入正确的手机号码"}],detailedAddress:[{required:!0,message:"请输入详细地址",trigger:"blur"}]}),y=n(),u=n(!1),d=n({receiverName:"",receiverPhone:"",province:"",city:"",district:"",detailedAddress:"",isDefault:!1}),g=n(!1),B=()=>{g.value=!1,d.value={receiverName:"",receiverPhone:"",province:"",city:"",district:"",detailedAddress:"",isDefault:!1},v.value=[],u.value=!0},M=i=>{g.value=!0,d.value={...i},v.value=[d.value.province,d.value.city,d.value.district],u.value=!0},I=i=>{i&&i.validate(async e=>{e&&([d.value.province,d.value.city,d.value.district]=v.value,g.value?await $(d.value):await U(d.value),c(),u.value=!1)})},w=n(-1),p=n(!1),R=async()=>{await q(w.value),p.value=!1,c()},O=async i=>{await P(i),c()};return(i,e)=>{const m=r("el-table-column"),S=r("el-tag"),o=r("el-button"),T=r("el-table"),b=r("el-input"),f=r("el-form-item"),j=r("el-cascader"),E=r("el-checkbox"),F=r("el-form"),k=r("el-dialog"),G=r("el-card");return V(),A(G,{class:"address-manager"},{default:a(()=>[t(T,{data:N(D),"highlight-current-row":"",stripe:""},{default:a(()=>[t(m,{type:"index",align:"center",label:"序号",width:"100"}),t(m,{align:"center",prop:"receiverName",label:"收货人"}),t(m,{align:"center",prop:"receiverPhone",label:"联系电话"}),t(m,{align:"center",label:"收货地址"},{default:a(l=>[s(x(l.row.province+l.row.city+l.row.district+l.row.detailedAddress),1)]),_:1}),t(m,{align:"center",label:"默认地址",width:"150"},{default:a(l=>[l.row.isDefault?(V(),A(S,{key:0,type:"success"},{default:a(()=>e[10]||(e[10]=[s("默认地址")])),_:1})):(V(),A(o,{key:1,type:"primary",size:"small",plain:"",onClick:C=>O(l.row.id)},{default:a(()=>e[11]||(e[11]=[s("设为默认")])),_:2},1032,["onClick"]))]),_:1}),t(m,{align:"center",label:"操作",width:"200"},{default:a(l=>[t(o,{onClick:C=>M(l.row),type:"primary",size:"small",link:""},{default:a(()=>e[12]||(e[12]=[s("编辑")])),_:2},1032,["onClick"]),t(o,{onClick:C=>{p.value=!0,w.value=l.row.id},type:"danger",size:"small",link:""},{default:a(()=>e[13]||(e[13]=[s("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),_("div",W,[t(o,{type:"primary",onClick:B,plain:""},{default:a(()=>e[14]||(e[14]=[s("添加新地址")])),_:1})]),t(k,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=l=>u.value=l),title:"地址信息",width:"500px"},{default:a(()=>[t(F,{model:d.value,"label-width":"100px",rules:z.value,ref_key:"currentAddressRef",ref:y},{default:a(()=>[t(f,{label:"收货人",prop:"receiverName"},{default:a(()=>[t(b,{modelValue:d.value.receiverName,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.receiverName=l),placeholder:"请输入收货人姓名"},null,8,["modelValue"])]),_:1}),t(f,{label:"联系电话",prop:"receiverPhone"},{default:a(()=>[t(b,{modelValue:d.value.receiverPhone,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value.receiverPhone=l),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),t(f,{label:"省/市/区"},{default:a(()=>[t(j,{options:N(J),modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=l=>v.value=l)},null,8,["options","modelValue"])]),_:1}),t(f,{label:"详细地址",prop:"detailedAddress"},{default:a(()=>[t(b,{modelValue:d.value.detailedAddress,"onUpdate:modelValue":e[3]||(e[3]=l=>d.value.detailedAddress=l),placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1}),t(f,null,{default:a(()=>[t(E,{modelValue:d.value.isDefault,"onUpdate:modelValue":e[4]||(e[4]=l=>d.value.isDefault=l)},{default:a(()=>e[15]||(e[15]=[s("设为默认地址")])),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),_("div",X,[t(o,{onClick:e[5]||(e[5]=l=>u.value=!1)},{default:a(()=>e[16]||(e[16]=[s("取消")])),_:1}),t(o,{type:"primary",onClick:e[6]||(e[6]=l=>I(y.value))},{default:a(()=>[s(x(g.value?"保存修改":"添加地址"),1)]),_:1})])]),_:1},8,["modelValue"]),t(k,{modelValue:p.value,"onUpdate:modelValue":e[9]||(e[9]=l=>p.value=l),title:"温馨提示",width:"500","align-center":""},{footer:a(()=>[_("div",Y,[t(o,{onClick:e[8]||(e[8]=l=>p.value=!1)},{default:a(()=>e[17]||(e[17]=[s("取消")])),_:1}),t(o,{type:"primary",onClick:R},{default:a(()=>e[18]||(e[18]=[s(" 确定 ")])),_:1})])]),default:a(()=>[e[19]||(e[19]=_("span",null,"你确定要删除吗？",-1))]),_:1},8,["modelValue"])]),_:1})}}}),re=Q(Z,[["__scopeId","data-v-7beedeb4"]]);export{re as default};
