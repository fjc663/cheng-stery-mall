import{u as q}from"./useAdmin-D4iKWU4I.js";import{u as M}from"./httpAdmin-C6IWq_Ob.js";import{u as N}from"./useUpload-DJmHiEKQ.js";import{d as P,e as v,i as F,c as V,w as l,r,o as f,b as _,a,u as t,h as R,t as S,f as m,D as $,_ as z}from"./index-CMV7StrB.js";import"./userApi-CmX0eGrO.js";import"./http-Bo0dlXKR.js";import"./axios-BimPEqV4.js";const E={class:"avatar-section"},L=["src"],T={class:"last-login"},j={class:"form-footer"},G=P({__name:"InfoView",setup(H){const{admin:o,getAdminUserInfo:b,saveAdminInfo:U}=q(),c=v(),A=v({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:20,message:"用户名字符长度为1到20",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{min:11,max:11,message:"请输入11位手机号码",trigger:"blur"},{pattern:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,message:"请输入正确的手机号码"}]}),{uploadAdminAvatar:w}=N(),x=async n=>{const e=new FormData;e.append("avatarFile",n.file);const d=await w(e);d.code===1&&(o.value.avatarUrl=d.data,M().setAvatar(d.data))},y=n=>n.size/1024/1024>2?($.error("头像大小必须小于2MB"),!1):!0,I=n=>{n&&n.validate(async e=>{e&&U()})};return F(()=>b()),(n,e)=>{const d=r("Plus"),g=r("el-icon"),k=r("el-upload"),i=r("el-input"),u=r("el-form-item"),p=r("el-radio"),B=r("el-radio-group"),C=r("el-form"),D=r("el-button"),h=r("el-card");return f(),V(h,{class:"user-info-card",shadow:"hover"},{default:l(()=>[_("div",E,[a(k,{class:"avatar-uploader","http-request":x,"show-file-list":!1,"before-upload":y},{default:l(()=>[t(o).avatarUrl?(f(),R("img",{key:0,src:t(o).avatarUrl,class:"user-avatar"},null,8,L)):(f(),V(g,{key:1,class:"avatar-upload-icon"},{default:l(()=>[a(d)]),_:1}))]),_:1})]),_("div",T," 最近登录时间："+S(t(o).lastLogin||"暂无记录"),1),a(C,{model:t(o),"label-width":"100px",class:"user-info-form",rules:A.value,ref_key:"adminUserRef",ref:c},{default:l(()=>[a(u,{label:"姓名",prop:"username"},{default:l(()=>[a(i,{modelValue:t(o).username,"onUpdate:modelValue":e[0]||(e[0]=s=>t(o).username=s),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),a(u,{label:"邮箱",prop:"email"},{default:l(()=>[a(i,{modelValue:t(o).email,"onUpdate:modelValue":e[1]||(e[1]=s=>t(o).email=s),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),a(u,{label:"电话",prop:"phone"},{default:l(()=>[a(i,{modelValue:t(o).phone,"onUpdate:modelValue":e[2]||(e[2]=s=>t(o).phone=s),placeholder:"请输入电话",maxlength:"11"},null,8,["modelValue"])]),_:1}),a(u,{label:"性别"},{default:l(()=>[a(B,{modelValue:t(o).gender,"onUpdate:modelValue":e[3]||(e[3]=s=>t(o).gender=s)},{default:l(()=>[a(p,{value:1},{default:l(()=>e[5]||(e[5]=[m("男")])),_:1}),a(p,{value:0},{default:l(()=>e[6]||(e[6]=[m("女")])),_:1}),a(p,{value:-1},{default:l(()=>e[7]||(e[7]=[m("保密")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),_("div",j,[a(D,{type:"primary",onClick:e[4]||(e[4]=s=>I(c.value))},{default:l(()=>e[8]||(e[8]=[m("保存")])),_:1})])]),_:1})}}}),Z=z(G,[["__scopeId","data-v-da873cb5"]]);export{Z as default};
