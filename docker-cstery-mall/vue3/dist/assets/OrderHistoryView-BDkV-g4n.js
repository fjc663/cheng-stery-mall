import{d as J,h as f,F as w,l as N,u as k,j as L,x as R,r as p,o as e,c as r,w as n,b as a,t as m,f as o,z as l,a as C,J as _,D as O,H as j,_ as U}from"./index-CMV7StrB.js";import{u as G}from"./useOrder-mXwGJRjg.js";import{u as K}from"./useCartItemsNumStore-BpwacNS2.js";import"./http-Bo0dlXKR.js";import"./axios-BimPEqV4.js";import"./httpAdmin-C6IWq_Ob.js";const P={class:"order-grid"},Q={class:"order-header"},W={class:"order-number"},X={class:"order-info"},Y={key:0},Z={class:"order-items"},h={class:"order-actions"},tt=J({__name:"OrderHistoryView",setup(st){const x=K(),{orders:B,getOrdersByStatus:v,cancelOrder:b,buyagain:I,countdowns:V,formatTime:$,completeOrder:q}=G(),g=L(),c=R(),z=u=>{g.push(`/orderDetail/${u}`)},S=async u=>{await b(u)===1&&O.success("取消成功");const i=c.query.status?Number(c.query.status):-1;v(i)},D=async u=>{const t=await I(u);x.getCartItemsNum(),g.push({path:"/cart",query:{selectedCartIds:JSON.stringify(t)}})},T=u=>{g.push(`/pay/${u}`)},A=u=>{j.confirm("确认完成订单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await q(u);const t=c.query.status?Number(c.query.status):-1;v(t)}).catch(()=>{O.info("已取消")})};return(u,t)=>{const i=p("el-tag"),E=p("el-image"),F=p("el-col"),H=p("el-row"),y=p("el-button"),M=p("el-card");return e(),f("div",P,[(e(!0),f(w,null,N(k(B),s=>(e(),r(M,{class:"order-card",key:s.id,onClick:d=>z(s.id),shadow:"hover"},{default:n(()=>[a("div",Q,[a("h3",W,"订单编号: "+m(s.orderNumber),1),s.status===1?(e(),r(i,{key:0,type:"warning"},{default:n(()=>t[0]||(t[0]=[o("待支付")])),_:1})):l("",!0),s.status===2?(e(),r(i,{key:1,type:"success"},{default:n(()=>t[1]||(t[1]=[o("已支付")])),_:1})):l("",!0),s.status===3?(e(),r(i,{key:2,type:"info"},{default:n(()=>t[2]||(t[2]=[o("已发货")])),_:1})):l("",!0),s.status===4?(e(),r(i,{key:3,type:"primary"},{default:n(()=>t[3]||(t[3]=[o("已完成")])),_:1})):l("",!0),s.status===5?(e(),r(i,{key:4,type:"danger"},{default:n(()=>t[4]||(t[4]=[o("已取消")])),_:1})):l("",!0)]),a("div",X,[a("p",null,[t[5]||(t[5]=a("strong",null,"总金额:",-1)),o(" ￥"+m(s.totalAmount.toFixed(2)),1)]),a("p",null,[t[6]||(t[6]=a("strong",null,"商品数量:",-1)),o(" "+m(s.itemCount)+" 件",1)]),a("p",null,[t[7]||(t[7]=a("strong",null,"下单时间:",-1)),o(" "+m(s.createdAt),1)]),s.status===1?(e(),f("div",Y,[a("p",null,[t[8]||(t[8]=a("strong",null,"剩余支付时间:",-1)),t[9]||(t[9]=o()),C(i,{type:"danger"},{default:n(()=>[o(m(k($)(k(V)[s.id])),1)]),_:2},1024)])])):l("",!0)]),a("div",Z,[C(H,{gutter:10},{default:n(()=>[(e(!0),f(w,null,N(s.orderItemVOList,d=>(e(),r(F,{span:8,key:d.productName},{default:n(()=>[C(E,{src:d.productImageUrl,class:"product-image",fit:"cover"},null,8,["src"])]),_:2},1024))),128))]),_:2},1024)]),a("div",h,[s.status===4?(e(),r(y,{key:0,type:"primary",size:"small",onClick:_(d=>D(s.id),["stop"])},{default:n(()=>t[10]||(t[10]=[o("再次购买")])),_:2},1032,["onClick"])):l("",!0),s.status===3?(e(),r(y,{key:1,type:"success",size:"small",onClick:_(d=>A(s.id),["stop"])},{default:n(()=>t[11]||(t[11]=[o("订单完成")])),_:2},1032,["onClick"])):l("",!0),s.status===1?(e(),r(y,{key:2,type:"warning",size:"small",onClick:_(d=>T(s.id),["stop"])},{default:n(()=>t[12]||(t[12]=[o("支付订单")])),_:2},1032,["onClick"])):l("",!0),s.status===1?(e(),r(y,{key:3,type:"danger",size:"small",onClick:_(d=>S(s.id),["stop"])},{default:n(()=>t[13]||(t[13]=[o("取消订单")])),_:2},1032,["onClick"])):l("",!0)])]),_:2},1032,["onClick"]))),128))])}}}),lt=U(tt,[["__scopeId","data-v-a5d0df59"]]);export{lt as default};
