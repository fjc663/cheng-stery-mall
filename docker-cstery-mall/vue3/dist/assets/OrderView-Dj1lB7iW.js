import{u as q}from"./useOrder-mXwGJRjg.js";import{d as H,e as v,i as J,c as _,w as l,r as s,o as n,b as r,a,h as c,l as z,F as O,f as u,t as i,z as y,u as S,H as $,D as V,_ as G}from"./index-CMV7StrB.js";import"./http-Bo0dlXKR.js";import"./axios-BimPEqV4.js";import"./httpAdmin-C6IWq_Ob.js";const K={class:"filter-section"},R={key:0},W={key:1},X={key:2},Y={key:3},Z={style:{margin:"20px 100px"}},ee={class:"specification-container"},te={class:"order-pagination-block"},ae=H({__name:"OrderView",setup(le){const{pageQueryAdmin:d,totalOrderAdmin:A,adminOrders:B,pageQueryOrder:g,setOrderStatus:N}=q(),b=v(1),w=v(20),U=v([{label:"全部订单",value:-1},{label:"待付款",value:1},{label:"已付款",value:2},{label:"已发货",value:3},{label:"已完成",value:4},{label:"已取消",value:5}]),m=v(-1),E=()=>{m.value!==-1?d.value.status=m.value:d.value.status=null,g()},I=p=>{$.confirm("确认发货吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await N(p,3)===1&&V.success("发货成功！"),g()}).catch(()=>{V.info("已取消发货")})},M=p=>{d.value.pageSize=p,g()},T=p=>{d.value.page=p,g()};return J(()=>{d.value.page=b.value,d.value.pageSize=w.value,g()}),(p,t)=>{const D=s("el-option"),F=s("el-select"),o=s("el-table-column"),x=s("el-tag"),h=s("el-button"),L=s("el-image"),k=s("el-table"),P=s("el-pagination"),Q=s("el-card");return n(),_(Q,{class:"order-management",shadow:"hover"},{default:l(()=>[r("div",K,[a(F,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),placeholder:"选择订单状态",onChange:E,class:"filter-select"},{default:l(()=>[(n(!0),c(O,null,z(U.value,e=>(n(),_(D,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),a(k,{data:S(B),style:{width:"100%"},stripe:"","header-cell-style":{"text-align":"center","background-color":"#f7f8fa","font-weight":"bold"},"cell-style":{"text-align":"center"}},{default:l(()=>[a(o,{prop:"orderNumber",label:"订单编号"}),a(o,{prop:"totalAmount",label:"金额"}),a(o,{prop:"status",label:"订单状态"},{default:l(e=>[a(x,{type:e.row.status===1?"warning":e.row.status===2?"success":e.row.status===3?"primary":e.row.status===4?"danger":"info"},{default:l(()=>[u(i(e.row.status===1?"待付款":e.row.status===2?"已付款":e.row.status===3?"已发货":e.row.status===4?"已完成":"已取消"),1)]),_:2},1032,["type"])]),_:1}),a(o,{prop:"createdAt",label:"创建时间"}),a(o,{label:"订单时间"},{default:l(e=>[e.row.status===2?(n(),c("div",R,[t[3]||(t[3]=r("strong",null,"付款时间：",-1)),u(" "+i(e.row.paidAt),1)])):e.row.status===3?(n(),c("div",W,[t[4]||(t[4]=r("strong",null,"发货时间：",-1)),u(" "+i(e.row.shippedAt),1)])):e.row.status===4?(n(),c("div",X,[t[5]||(t[5]=r("strong",null,"完成时间：",-1)),u(" "+i(e.row.completedAt),1)])):e.row.status===5?(n(),c("div",Y,[t[6]||(t[6]=r("strong",null,"取消时间：",-1)),u(" "+i(e.row.canceledAt),1)])):y("",!0)]),_:1}),a(o,{label:"操作"},{default:l(e=>[e.row.status===2?(n(),_(h,{key:0,type:"success",link:"",onClick:f=>I(e.row.id)},{default:l(()=>t[7]||(t[7]=[u("发货")])),_:2},1032,["onClick"])):y("",!0),e.row.status===3?(n(),_(h,{key:1,type:"warning",link:"",disabled:""},{default:l(()=>t[8]||(t[8]=[u("等待完成")])),_:1})):y("",!0)]),_:1}),a(o,{type:"expand",label:"订单商品",width:"200"},{default:l(e=>[r("div",Z,[a(k,{data:e.row.orderItemVOList,style:{width:"100%"},border:"","header-cell-style":{"text-align":"center","background-color":"#f7f8fa","font-weight":"bold"},"cell-style":{"text-align":"center"}},{default:l(()=>[a(o,{prop:"productName",label:"商品名称"}),a(o,{prop:"quantity",label:"数量"}),a(o,{prop:"productPrice",label:"单价"}),a(o,{label:"规格"},{default:l(f=>[r("div",ee,[(n(!0),c(O,null,z(JSON.parse(f.row.specifications),(j,C)=>(n(),_(x,{key:C,size:"small",effect:"dark",class:"specification-tag"},{default:l(()=>[u(i(C)+": "+i(j),1)]),_:2},1024))),128))])]),_:1}),a(o,{label:"图片"},{default:l(f=>[a(L,{src:f.row.productImageUrl,fit:"cover",style:{width:"50px",height:"50px"}},null,8,["src"])]),_:1})]),_:2},1032,["data"])])]),_:1})]),_:1},8,["data"]),r("div",te,[a(P,{"current-page":b.value,"onUpdate:currentPage":t[1]||(t[1]=e=>b.value=e),"page-size":w.value,"onUpdate:pageSize":t[2]||(t[2]=e=>w.value=e),"page-sizes":[20,40,60,80,100],layout:"total, sizes, prev, pager, next, jumper",total:S(A),onSizeChange:M,onCurrentChange:T},null,8,["current-page","page-size","total"])])]),_:1})}}}),ie=G(ae,[["__scopeId","data-v-d07b6f52"]]);export{ie as default};
