import{d as ne,e as u,i as se,c as B,w as a,r as s,o as b,a as t,b as _,f as i,t as k,h as D,l as M,F as T,u as h,B as ie,H as ue,D as re,_ as pe}from"./index-CMV7StrB.js";import{u as de}from"./useSpecification-CLfyhdqd.js";import"./httpAdmin-C6IWq_Ob.js";import"./axios-BimPEqV4.js";const ce={class:"search-controls"},me={class:"spec-pagination-block"},fe={class:"dialog-footer"},ve=ne({__name:"SpecificationView",setup(ge){const{specList:K,totalSpec:L,pageQuery:p,pageQuerySepc:d,addSepc:Q,editSepc:U,deleteSepc:R}=de(),S=u(1),x=u(10),f=u(!1),y=u(!1),n=u({id:null,name:"",description:"",status:0,specificationOptions:""}),$=u(),A=u({name:[{required:!0,message:"规格名称不能为空",trigger:"blur"},{min:1,max:20,message:"规格名称长度应为 1 到 20 个字符",trigger:"blur"}],description:[{required:!0,message:"规格描述不能为空",trigger:"blur"},{max:30,message:"规格描述最多为30个字符",trigger:"blur"}],specificationOptions:[{required:!0,message:"规格选项不能为空",trigger:"blur"}]}),H=()=>{y.value=!1,f.value=!0,n.value={id:null,name:"",description:"",status:0,specificationOptions:""}},I=o=>{y.value=!0,f.value=!0,Object.assign(n.value,o),n.value.specificationOptions&&(v.value=n.value.specificationOptions.split(","))},v=u([]),w=u(""),F=()=>{const o=w.value.trim();o&&!v.value.includes(o)&&v.value.push(o),w.value=""},P=o=>{v.value.splice(o,1)},W=o=>{o&&o.validate(async e=>{e&&(n.value.specificationOptions=v.value.join(","),y.value?await U(n.value):await Q(n.value),d(),f.value=!1)})},G=o=>{ue.confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await R(o),d()}).catch(()=>{re({type:"info",message:"已取消删除"})})},r=u({name:"",status:-1}),E=()=>{p.value.name=r.value.name,r.value.status===0||r.value.status===1?p.value.status=r.value.status:p.value.status=null,d()},J=async(o,e)=>{n.value={id:o,status:e},await U(n.value),d()},X=o=>{p.value.pageSize=o,d()},Y=o=>{p.value.page=o,d()};return se(()=>{p.value.page=S.value,p.value.pageSize=x.value,d()}),(o,e)=>{const c=s("el-button"),V=s("el-input"),O=s("el-option"),Z=s("el-select"),N=s("el-card"),g=s("el-table-column"),z=s("el-tag"),ee=s("el-table"),te=s("el-pagination"),C=s("el-form-item"),j=s("el-radio"),le=s("el-radio-group"),ae=s("el-form"),oe=s("el-dialog");return b(),B(N,{class:"specification-management",shadow:"hover"},{default:a(()=>[t(N,{class:"search-card",shadow:"hover"},{default:a(()=>[_("div",ce,[t(V,{modelValue:r.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.name=l),placeholder:"请输入分类名称",clearable:"",class:"search-input"},{append:a(()=>[t(c,{onClick:E},{default:a(()=>e[11]||(e[11]=[_("svg",{class:"icon","aria-hidden":"true"},[_("use",{"xlink:href":"#icon-find"})],-1)])),_:1})]),_:1},8,["modelValue"]),t(Z,{modelValue:r.value.status,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.status=l),onChange:E,placeholder:"请选择分类状态",clearable:"",class:"status-select"},{default:a(()=>[t(O,{label:"全部",value:-1}),t(O,{label:"启用",value:1}),t(O,{label:"禁用",value:0})]),_:1},8,["modelValue"]),t(c,{class:"add-category-btn",type:"primary",plain:"",onClick:H},{default:a(()=>e[12]||(e[12]=[i(" 添加规格 ")])),_:1})])]),_:1}),t(ee,{data:h(K),border:"",stripe:"",style:{width:"100%"},"header-cell-style":{"text-align":"center",background:"#fafafa",fontWeight:"bold"},"cell-style":{"text-align":"center"}},{default:a(()=>[t(g,{type:"index",label:"序号",width:"60"}),t(g,{prop:"name",label:"规格名称"}),t(g,{prop:"description",label:"规格描述"}),t(g,{prop:"status",label:"状态",width:"100"},{default:a(l=>[t(z,{type:l.row.status===1?"success":"danger"},{default:a(()=>[i(k(l.row.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(g,{prop:"specificationOptions",label:"规格选项"},{default:a(l=>[(b(!0),D(T,null,M(l.row.specificationOptions.split(","),(m,q)=>(b(),B(z,{key:q},{default:a(()=>[i(k(m),1)]),_:2},1024))),128))]),_:1}),t(g,{label:"操作",width:"220"},{default:a(l=>[t(c,{type:l.row.status===1?"danger":"success",size:"small",link:"",onClick:m=>J(l.row.id,l.row.status===1?0:1)},{default:a(()=>[i(k(l.row.status===1?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(c,{size:"small",onClick:m=>I(l.row),type:"primary",link:""},{default:a(()=>e[13]||(e[13]=[i("编辑")])),_:2},1032,["onClick"]),t(c,{size:"small",onClick:m=>G(l.row.id),type:"danger",link:""},{default:a(()=>e[14]||(e[14]=[i("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),_("div",me,[t(te,{"current-page":S.value,"onUpdate:currentPage":e[2]||(e[2]=l=>S.value=l),"page-size":x.value,"onUpdate:pageSize":e[3]||(e[3]=l=>x.value=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:h(L),onSizeChange:X,onCurrentChange:Y},null,8,["current-page","page-size","total"])]),t(oe,{modelValue:f.value,"onUpdate:modelValue":e[10]||(e[10]=l=>f.value=l),width:"500px",title:y.value?"编辑规格":"添加规格"},{default:a(()=>[t(ae,{model:n.value,"label-width":"100px",rules:A.value,ref_key:"specificationFormRef",ref:$},{default:a(()=>[t(C,{label:"规格名称",prop:"name"},{default:a(()=>[t(V,{modelValue:n.value.name,"onUpdate:modelValue":e[4]||(e[4]=l=>n.value.name=l),placeholder:"请输入规格名称"},null,8,["modelValue"])]),_:1}),t(C,{label:"规格描述",prop:"description"},{default:a(()=>[t(V,{modelValue:n.value.description,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.description=l),placeholder:"请输入规格描述"},null,8,["modelValue"])]),_:1}),t(C,{label:"状态",prop:"status"},{default:a(()=>[t(le,{modelValue:n.value.status,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value.status=l)},{default:a(()=>[t(j,{value:1},{default:a(()=>e[15]||(e[15]=[i("启用")])),_:1}),t(j,{value:0},{default:a(()=>e[16]||(e[16]=[i("禁用")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(C,{label:"规格选项"},{default:a(()=>[_("div",null,[(b(!0),D(T,null,M(v.value,(l,m)=>(b(),B(z,{key:m,closable:"",onClose:q=>P(Number(m))},{default:a(()=>[i(k(l),1)]),_:2},1032,["onClose"]))),128)),t(V,{modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=l=>w.value=l),placeholder:"按 Enter 添加",onKeyup:ie(F,["enter"]),onBlur:F,class:"input-new-option"},null,8,["modelValue"])])]),_:1})]),_:1},8,["model","rules"]),_("div",fe,[t(c,{onClick:e[8]||(e[8]=l=>f.value=!1)},{default:a(()=>e[17]||(e[17]=[i("取消")])),_:1}),t(c,{type:"primary",onClick:e[9]||(e[9]=l=>W($.value))},{default:a(()=>e[18]||(e[18]=[i("保存")])),_:1})])]),_:1},8,["modelValue","title"])]),_:1})}}}),Ve=pe(ve,[["__scopeId","data-v-da810116"]]);export{Ve as default};
