import{d as ee,e as d,i as te,c as f,w as l,x as ae,j as oe,r as o,k as ne,o as i,a as s,h as w,l as z,f as V,t as p,u as h,F as B,b as r,B as le,p as se,_ as re}from"./index-CMV7StrB.js";import{u as ce}from"./useCategory-DUTDZwFS.js";import{u as ie}from"./useProduct-D_j9yIew.js";import"./http-Bo0dlXKR.js";import"./axios-BimPEqV4.js";import"./httpAdmin-C6IWq_Ob.js";const ue={class:"search-bar"},de={alt:"product image",class:"product-image"},pe={class:"product-info"},_e={class:"product-title"},me={class:"product-description"},ge={style:{"min-width":"80px","max-width":"500px","text-align":"center"}},ve={key:1},ye={class:"product-price"},fe={class:"product-pagination-block"},he=ee({__name:"SubCategoryView",setup(Ce){const c=ae(),I=oe(),{subCategories:u,getSubCategoryList:N}=ce(),{products:D,totalProduct:P,pageQuery:n,pageQueryByCategoryId:_}=ie(),q=c.query.name,O=Number(c.params.categoryId),v=d(0),y=d(""),U=t=>{var a;v.value=t,y.value=((a=u.value.find(g=>g.id==t))==null?void 0:a.name)||"",n.value.categoryId=t,_()},C=d(""),b=()=>{n.value.name=C.value,_()},m=d("none"),L=t=>{n.value.isOrderBypriceASC=t==="asc",n.value.isOrderBypriceDESC=t==="desc",_()},A=(t,a,g)=>{I.push({path:"/productDetail/"+t,query:{name:a,subName:g,redirect:c.fullPath}})},S=d(1),x=d(20),E=t=>{n.value.page=t,_()},Q=t=>{n.value.pageSize=t,_()};return te(async()=>{if(await N(O),c.query.subCategoryId&&c.query.subCategoryName){const t=c.query.subCategoryId;n.value.categoryId=t,v.value=t,y.value=c.query.subCategoryName}else u.value.length>0?(n.value.categoryId=u.value[0].id,v.value=u.value[0].id,y.value=u.value[0].name):n.value.categoryId=-1;n.value.page=S.value,n.value.pageSize=x.value,n.value.isALLData=!1,n.value.isOrderBypriceASC?m.value="asc":n.value.isOrderBypriceDESC?m.value="desc":m.value="none",b()}),console.log(c.fullPath),(t,a)=>{const g=o("el-menu-item"),j=o("el-menu"),F=o("el-aside"),K=o("el-button"),R=o("el-input"),k=o("el-option"),M=o("el-select"),T=o("el-tooltip"),$=o("el-card"),G=o("el-col"),H=o("el-row"),J=o("el-pagination"),W=o("el-main"),X=o("el-backtop"),Y=o("el-container"),Z=ne("lazy");return i(),f(Y,{class:"category-page"},{default:l(()=>[s(F,{width:"240px",class:"sidebar"},{default:l(()=>[s(j,{"default-active":v.value.toString(),class:"menu",onSelect:U},{default:l(()=>[(i(!0),w(B,null,z(h(u),e=>(i(),f(g,{key:e.id,index:e.id.toString()},{default:l(()=>[V(p(e.name),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),_:1}),s(W,{class:"products-section"},{default:l(()=>[r("div",ue,[r("div",null,[s(R,{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value=e),placeholder:"搜索商品...",onKeyup:le(b,["enter"]),style:{"margin-right":"10px"},clearable:""},{append:l(()=>[s(K,{onClick:b},{default:l(()=>a[4]||(a[4]=[r("svg",{class:"icon","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-find"})],-1)])),_:1})]),_:1},8,["modelValue"])]),s(M,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),placeholder:"价格排序",onChange:L,class:"select-prict-order"},{default:l(()=>[s(k,{label:"默认",value:"none"}),s(k,{label:"价格升序",value:"asc"}),s(k,{label:"价格降序",value:"desc"})]),_:1},8,["modelValue"])]),s(H,{gutter:20,class:"products-grid"},{default:l(()=>[(i(!0),w(B,null,z(h(D),e=>(i(),f(G,{xs:24,sm:12,md:8,lg:6,key:e.id},{default:l(()=>[s($,{shadow:"hover",class:"product-card",onClick:be=>A(e.id,h(q),y.value)},{default:l(()=>[se(r("img",de,null,512),[[Z,e.imageUrl]]),r("div",pe,[r("h3",_e,p(e.name),1),r("p",me,[e.description.length>20?(i(),f(T,{key:0,placement:"bottom",effect:"light","popper-class":"custom-tooltip"},{content:l(()=>[r("div",ge,p(e.description),1)]),default:l(()=>[V(" "+p(e.description.slice(0,20)+"..."),1)]),_:2},1024)):(i(),w("span",ve,p(e.description),1))]),r("p",ye,"￥"+p(e.price),1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),r("div",fe,[s(J,{"current-page":S.value,"onUpdate:currentPage":a[2]||(a[2]=e=>S.value=e),"page-size":x.value,"onUpdate:pageSize":a[3]||(a[3]=e=>x.value=e),"page-sizes":[20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:h(P),onSizeChange:E,onCurrentChange:Q},null,8,["current-page","page-size","total"])])]),_:1}),s(X,{right:100,bottom:100})]),_:1})}}}),Be=re(he,[["__scopeId","data-v-656deb43"]]);export{Be as default};
