import{h as a}from"./http-Bo0dlXKR.js";import{h as u}from"./httpAdmin-C6IWq_Ob.js";import{e as s,D as t}from"./index-CMV7StrB.js";function p(e){return a({url:"user/order",method:"Post",data:e})}function f(e){return a({url:"user/order/status/"+e})}function g(e){return a({url:"user/order",params:{id:e}})}function y(e){return a({url:`user/order/cancel/${e}`,method:"Put"})}function A(e){return a({url:`user/order/pay/${e}`,method:"Put"})}function O(e){return a({url:`user/order/complete/${e}`,method:"Put"})}function h(e){return a({url:`user/order/buyagain/${e}`,method:"Post"})}function v(e){return u({url:"admin/order/page",params:e})}function w(e,r){return u({url:`admin/order/status/${r}`,method:"Put",params:{id:e}})}const c=s([]),i=s({id:0,orderNumber:"",totalAmount:0,status:0,paymentStatus:0,paymentMethod:0,shippingAddress:"",shippingCost:0,itemCount:0,discountAmount:0,createdAt:"",paidAt:"",shippedAt:"",completedAt:"",canceledAt:"",remark:"",orderItemVOList:[]}),P=async e=>{const r=await f(e);if(r.code===0){t.error(r.msg);return}c.value=r.data},I=async e=>{const r=await g(e);if(r.code===0){t.error(r.msg);return}i.value=r.data},S=async e=>{const r=await y(e);return r.code===0&&t.error(r.msg),r.code},D=async e=>{const r=await A(e);return r.code===0&&t.error(r.msg),r.code},$=async e=>{const r=await O(e);r.code===1?t.success("订单完成"):t.error(r.msg)},b=async e=>{const r=await h(e);return r.code===0?(t.error(r.msg),[]):r.data},T=async e=>{const r=await p(e);return r.code===0&&t.error(r.msg),r},o=s({}),M=e=>{const r=new Date(e).getTime(),n=new Date().getTime();return Math.max(9e5-(n-r),0)},C=()=>{c.value.forEach(e=>{if(e.status===1&&o.value[e.id]===void 0){o.value[e.id]=M(e.createdAt);const r=setInterval(()=>{o.value[e.id]>0?o.value[e.id]-=1e3:clearInterval(r)},1e3)}})},Q=e=>{const r=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3);return`${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`},d=s([]),m=s(0),l=s({page:1,pageSize:20}),x=async()=>{const e=await v(l.value);if(e.code===0){t.error(e.msg);return}m.value=e.data.total,d.value=e.data.records},B=async(e,r)=>{const n=await w(e,r);return n.code===0&&t.error(n.msg),n.code};function N(){return{orders:c,orderDetail:i,getOrdersByStatus:P,getOrderDetail:I,cancelOrder:S,payOrder:D,completeOrder:$,submitOrder:T,buyagain:b,initCountdowns:C,countdowns:o,formatTime:Q,adminOrders:d,pageQueryAdmin:l,totalOrderAdmin:m,pageQueryOrder:x,setOrderStatus:B}}export{N as u};
